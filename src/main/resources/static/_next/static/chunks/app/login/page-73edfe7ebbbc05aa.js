(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{722:(e,t,s)=>{"use strict";s.d(t,{A:()=>o});var a=s(3464),r=s(9323),l=s(1487);let n=a.A.create({baseURL:"http://localhost:8080/v1/api",headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>{let t=(0,r.gf)();return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),n.interceptors.response.use(e=>e,e=>{var t,s;let a=null==(t=e.config.url)?void 0:t.endsWith("/login");if((null==(s=e.response)?void 0:s.status)===401&&!a){let{clearAuth:e}=l.C.getState();e(),window.location.href="/login"}return Promise.reject(e)});let o=n},1487:(e,t,s)=>{"use strict";s.d(t,{C:()=>l});var a=s(5453),r=s(6786);let l=(0,a.v)((0,r.Zr)(e=>({authName:null,token:null,setAuthName:t=>e({authName:t}),setToken:t=>e({token:t}),clearAuth:()=>e({authName:null,token:null})}),{name:"auth-storage",partialize:e=>({authName:e.authName,token:e.token})}))},6552:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var a=s(5155),r=s(2177),l=s(6766),n=s(5695),o=s(2115),i=s(9323);function u(){let{register:e,handleSubmit:t,formState:{errors:s}}=(0,r.mN)(),[u,d]=(0,o.useState)(""),c=(0,n.useRouter)(),m=async e=>{try{await (0,i.EN)(e.username,e.password),c.push("/inventory")}catch(e){var t,s,a;console.log(e),d(null!=(a=null==e||null==(s=e.response)||null==(t=s.data)?void 0:t.message)?a:"ログインに失敗しました")}};return(0,a.jsxs)("div",{className:"flex bg-white w-full justify-center",children:[(0,a.jsxs)("div",{className:"bg-white p-20 max-w-md",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold mb-6",children:"ログイン"}),(0,a.jsxs)("form",{onSubmit:t(m),className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-1 font-medium",children:"ログインID*"}),(0,a.jsx)("input",{type:"text",...e("username",{required:"ログインIDを入力してください"}),className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-gray-100",style:{border:"1px solid #9F9F9F"},placeholder:"user name"}),s.username&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:s.username.message})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block mb-1 font-medium",children:"パスワード*"}),(0,a.jsx)("input",{type:"password",...e("password",{required:"パスワードを入力してください"}),className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-gray-100",style:{border:"1px solid #9F9F9F"},placeholder:"password"}),s.password&&(0,a.jsx)("p",{className:"text-sm text-red-500 mt-1",children:s.password.message})]}),u&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:u}),(0,a.jsx)("button",{type:"submit",className:"w-full bg-[#101540] text-white py-2 rounded hover:bg-[#1d1f3c]",children:"ログイン"}),(0,a.jsx)("p",{className:"text-sm",children:"ID・パスワードを忘れたりログインができない場合、管理者にお問い合わせください。"})]})]}),(0,a.jsx)("div",{className:"hidden md:flex w-1/2 items-center justify-center max-w-md",children:(0,a.jsx)(l.default,{src:"/img_login.png",alt:"Login Visual",className:"w-3/4 h-auto object-contain shadow",width:410,height:285})})]})}function d(){return(0,a.jsx)("div",{className:"",children:(0,a.jsx)(u,{})})}},6580:(e,t,s)=>{Promise.resolve().then(s.bind(s,6552))},9323:(e,t,s)=>{"use strict";s.d(t,{EN:()=>l,gf:()=>o,ri:()=>n});var a=s(1487),r=s(722);let l=async(e,t)=>{let s=await r.A.post("/login",{username:e,password:t});console.log("axios response:",s);let l=s.data.data.token,n=s.data.data.username;if(!l)throw Error("トークンが取得できませんでした");a.C.getState().setToken(l),a.C.getState().setAuthName(n)},n=()=>{a.C.getState().clearAuth()},o=()=>a.C.getState().token||localStorage.getItem("authToken")}},e=>{var t=t=>e(e.s=t);e.O(0,[655,764,441,684,358],()=>t(6580)),_N_E=e.O()}]);