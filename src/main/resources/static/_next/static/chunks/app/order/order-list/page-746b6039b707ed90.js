(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[829],{321:(e,s,t)=>{"use strict";t.d(s,{A:()=>c});var a=t(5155),l=t(9946);let n=(0,l.A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),r=(0,l.A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);function c(e){let{currentPage:s,totalPages:t,onPageChange:l}=e;return t<=1?null:(0,a.jsxs)("div",{className:"flex justify-center items-center mt-6 gap-2",children:[(0,a.jsx)("button",{onClick:()=>l(s-1),disabled:0===s,className:"disabled:text-gray-400",children:(0,a.jsx)(n,{})}),[...Array(t)].map((e,t)=>(0,a.jsx)("button",{onClick:()=>l(t),disabled:t===s,className:"px-3 py-1 rounded ".concat(t===s?"text-gray-400":"hover:bg-gray-300"),children:t+1},t)),(0,a.jsx)("button",{onClick:()=>l(s+1),disabled:s===t-1,className:"disabled:text-gray-400",children:(0,a.jsx)(r,{})})]})}},722:(e,s,t)=>{"use strict";t.d(s,{A:()=>c});var a=t(3464),l=t(9323),n=t(1487);let r=a.A.create({baseURL:"http://localhost:8080/v1/api",headers:{"Content-Type":"application/json"}});r.interceptors.request.use(e=>{let s=(0,l.gf)();return s&&(e.headers.Authorization="Bearer ".concat(s)),e}),r.interceptors.response.use(e=>e,e=>{var s,t;let a=null==(s=e.config.url)?void 0:s.endsWith("/login");if((null==(t=e.response)?void 0:t.status)===401&&!a){let{clearAuth:e}=n.C.getState();e(),window.location.href="/login"}return Promise.reject(e)});let c=r},1487:(e,s,t)=>{"use strict";t.d(s,{C:()=>n});var a=t(5453),l=t(6786);let n=(0,a.v)((0,l.Zr)(e=>({authName:null,token:null,setAuthName:s=>e({authName:s}),setToken:s=>e({token:s}),clearAuth:()=>e({authName:null,token:null})}),{name:"auth-storage",partialize:e=>({authName:e.authName,token:e.token})}))},1756:(e,s,t)=>{Promise.resolve().then(t.bind(t,9125))},2596:(e,s,t)=>{"use strict";t.d(s,{A:()=>l});var a=t(5155);function l(){return(0,a.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-[#0d113d] opacity-70 z-50",children:(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsxs)("svg",{className:"animate-spin w-16 h-16",viewBox:"0 0 50 50",children:[(0,a.jsx)("defs",{children:(0,a.jsxs)("linearGradient",{id:"spinner-gradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[(0,a.jsx)("stop",{offset:"0%",stopColor:"#3D00B8"}),(0,a.jsx)("stop",{offset:"100%",stopColor:"#3070C3"})]})}),(0,a.jsx)("circle",{cx:"25",cy:"25",r:"20",stroke:"url(#spinner-gradient)",strokeWidth:"6",fill:"none",strokeLinecap:"round"})]}),(0,a.jsx)("span",{className:"mt-4 text-lg font-semibold text-white drop-shadow",children:"ローディング中..."})]})})}},7039:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("package-plus",[["path",{d:"M16 16h6",key:"100bgy"}],["path",{d:"M19 13v6",key:"85cyf1"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]])},9125:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>x});var a=t(5155),l=t(2115),n=t(722),r=t(9946);let c=(0,r.A)("square-minus",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}]]),i=(0,r.A)("square-plus",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);var o=t(7039);function d(e){let{orders:s,onRegisterDelivery:t}=e,[n,r]=(0,l.useState)(null);return(0,a.jsxs)("div",{className:"rounded bg-white text-center",children:[(0,a.jsxs)("div",{className:"grid grid-cols-18 font-semibold p-2",children:[(0,a.jsx)("span",{className:"col-span-2",children:"発注番号"}),(0,a.jsx)("span",{className:"col-span-2",children:"仕入れ先"}),(0,a.jsx)("span",{className:"col-span-2",children:"小計"}),(0,a.jsx)("span",{className:"col-span-2",children:"送料"}),(0,a.jsx)("span",{className:"col-span-2",children:"発注日"}),(0,a.jsx)("span",{className:"col-span-2",children:"担当者"}),(0,a.jsx)("span",{className:"col-span-2",children:"ステータス"}),(0,a.jsx)("span",{className:"col-span-3",children:"備考"}),(0,a.jsx)("span",{className:"col-span-1",children:"詳細"})]}),s.map((e,s)=>{var d,h;return(0,a.jsx)(l.Fragment,{children:(0,a.jsxs)("div",{className:"grid grid-cols-18 gap-y-4 items-center py-2 hover:bg-gray-50 border-b text-sm",onClick:()=>r(n===s?null:s),children:[(0,a.jsx)("span",{className:"col-span-2",children:e.orderNo}),(0,a.jsx)("span",{className:"col-span-2",children:e.supplier}),(0,a.jsxs)("span",{className:"col-span-2",children:[null==(d=e.orderSubtotal)?void 0:d.toLocaleString(),"円"]}),(0,a.jsxs)("span",{className:"col-span-2",children:[null==(h=e.shippingFee)?void 0:h.toLocaleString(),"円"]}),(0,a.jsx)("span",{className:"col-span-2",children:e.orderDate}),(0,a.jsx)("span",{className:"col-span-2",children:e.operator}),(0,a.jsx)("span",{className:"\n                px-3 py-1 rounded-full text-xs col-span-2\n                ".concat("完了"===e.status?"bg-green-500 text-white":"未完了"===e.status||"未入庫"===e.status?"bg-lime-300 text-green-900":"一部入庫"===e.status?"bg-yellow-400 text-yellow-900":"","\n              "),children:e.status}),(0,a.jsx)("span",{className:"truncate col-span-3",title:e.remarks,children:e.remarks}),(0,a.jsx)("span",{className:"col-span-1",children:(0,a.jsx)("button",{className:" transition-transform duration-300 ".concat(n===s?"rotate-180":"rotate-0"),children:n===s?(0,a.jsx)(c,{}):(0,a.jsx)(i,{})})}),(0,a.jsx)("div",{className:"col-span-18 transition-all duration-500 ease-in-out overflow-hidden ".concat(n===s?"max-h-[400px]":"max-h-0"),children:(0,a.jsxs)("table",{className:"w-full text-sm py-2 ",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"font-semibold bg-blue-50",children:[(0,a.jsx)("th",{className:"py-1 col-span-3",children:"在庫ID"}),(0,a.jsx)("th",{className:"py-1 col-span-3",children:"品名"}),(0,a.jsx)("th",{className:"py-1 col-span-2",children:"型番"}),(0,a.jsx)("th",{className:"py-1 col-span-2",children:"カテゴリ"}),(0,a.jsx)("th",{className:"py-1 col-span-2",children:"発注数"}),(0,a.jsx)("th",{className:"py-1 col-span-2",children:"受領数"}),(0,a.jsx)("th",{className:"py-1 col-span-2",children:"単価"}),(0,a.jsx)("th",{className:"py-1 col-span-2",children:"ステータス"}),(0,a.jsx)("th",{className:"py-1 col-span-2",children:"更新"})]})}),(0,a.jsx)("tbody",{children:(e.details||[]).map((e,s)=>(0,a.jsxs)("tr",{className:"".concat(s%2==0?"bg-gray-50":"bg-blue-50"),children:[(0,a.jsx)("td",{className:"py-2 col-span-2",children:e.itemCode}),(0,a.jsx)("td",{className:"py-2 truncate max-w-[150px] col-span-2",children:e.itemName}),(0,a.jsx)("td",{className:"py-2 col-span-2",children:e.modelNumber}),(0,a.jsx)("td",{className:"py-2 col-span-2",children:e.category}),(0,a.jsx)("td",{className:"py-2 col-span-2",children:e.quantity}),(0,a.jsx)("td",{className:"py-2 col-span-2",children:e.receivedQuantity}),(0,a.jsxs)("td",{className:"py-2 col-span-2",children:[e.purchasePrice,"円"]}),(0,a.jsx)("td",{children:(0,a.jsx)("span",{className:"\n                          px-5 py-1 rounded-full text-xs\n                          ".concat("完了"===e.status?"bg-green-500 text-white":"未完了"===e.status||"未入庫"===e.status?"bg-lime-300 text-green-900":"一部入庫"===e.status?"bg-yellow-400 text-yellow-900":"","\n                        "),children:e.status})}),(0,a.jsx)("td",{className:"py-2 col-span-2",children:(0,a.jsx)("button",{className:"text-xs text-white rounded px-2 py-1 "+("完了"!==e.status?"hover:opacity-80 transition":""),onClick:s=>{t(e),s.stopPropagation()},disabled:"完了"===e.status,children:(0,a.jsx)(o.A,{style:"完了"===e.status?{color:"#9CA3AF"}:{color:"#0d113d"}})})})]},e.itemCode))})]})})]})},e.orderNo)})]})}function h(e){var s;let{open:t,detail:n,onClose:r,onSubmit:c}=e,i=n.quantity-(null!=(s=n.receivedQuantity)?s:0),[o,d]=(0,l.useState)(n.quantity);return((0,l.useEffect)(()=>{d(i)},[n]),t)?(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/30",children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded shadow-lg w-[340px]",children:[(0,a.jsx)("h3",{className:"font-bold mb-2",children:"納品登録"}),(0,a.jsxs)("div",{className:"mb-4 text-sm space-y-1",children:[(0,a.jsxs)("div",{children:["在庫ID: ",(0,a.jsx)("span",{className:"font-mono",children:n.itemCode})]}),(0,a.jsxs)("div",{children:["品名: ",n.itemName]}),(0,a.jsxs)("div",{children:["発注数: ",n.quantity]}),(0,a.jsxs)("div",{children:["受領数: ",n.receivedQuantity]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block mb-1 text-xs",children:"納品数"}),(0,a.jsx)("input",{type:"number",value:o,min:1,max:i,className:"w-full border rounded px-2 py-1",onChange:e=>d(Number(e.target.value))})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("button",{onClick:r,className:"px-4 py-1 rounded bg-gray-300",children:"キャンセル"}),(0,a.jsx)("button",{onClick:()=>c(n,o),className:"px-4 py-1 rounded bg-blue-600 text-white",children:"登録"})]})]})}):null}var p=t(321),u=t(2596);function x(){let[e,s]=(0,l.useState)(null),[t,r]=(0,l.useState)(!1),[c,i]=(0,l.useState)([]),[o,x]=(0,l.useState)(0),[m,j]=(0,l.useState)(0),[y,g]=(0,l.useState)(!0);(0,l.useEffect)(()=>{(async()=>{try{let e=await n.A.get("/order-history",{params:{page:o,size:10}});console.log(e.data.content),i(e.data.content),j(e.data.totalPages)}catch(e){if(console.error(e),e.response&&e.response.data){let s=e.response.data;alert("エラーが発生しました！以下の内容を管理者に伝えてください。\n・error: ".concat(s.error,"\n・massage: ").concat(s.message,"\n・status: ").concat(s.status)),console.error("発注履歴取得エラー:",e)}}finally{g(!1)}})()},[o]);let N=()=>r(!1),b=async(e,s)=>{console.log("%o",e),await n.A.post("/receive-from-order",{orderNo:e.orderNo,items:[{itemCode:e.itemCode,receivedQuantity:s}]}),N()};return(0,a.jsxs)(a.Fragment,{children:[y&&(0,a.jsx)(u.A,{}),(0,a.jsxs)("main",{className:"bg-white border-gray-400 p-3 shadow p-5",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"発注履歴一覧"}),(0,a.jsx)(d,{orders:c,onRegisterDelivery:e=>{s(e),r(!0)}}),e&&(0,a.jsx)(h,{open:t,detail:e,onClose:N,onSubmit:b}),(0,a.jsx)(p.A,{currentPage:o,totalPages:m,onPageChange:x})]})]})}},9323:(e,s,t)=>{"use strict";t.d(s,{EN:()=>n,gf:()=>c,ri:()=>r});var a=t(1487),l=t(722);let n=async(e,s)=>{let t=await l.A.post("/login",{username:e,password:s});console.log("axios response:",t);let n=t.data.data.token,r=t.data.data.username;if(!n)throw Error("トークンが取得できませんでした");a.C.getState().setToken(n),a.C.getState().setAuthName(r)},r=()=>{a.C.getState().clearAuth()},c=()=>a.C.getState().token||localStorage.getItem("authToken")},9946:(e,s,t)=>{"use strict";t.d(s,{A:()=>h});var a=t(2115);let l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,s,t)=>t?t.toUpperCase():s.toLowerCase()),r=e=>{let s=n(e);return s.charAt(0).toUpperCase()+s.slice(1)},c=function(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return s.filter((e,s,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===s).join(" ").trim()},i=e=>{for(let s in e)if(s.startsWith("aria-")||"role"===s||"title"===s)return!0};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let d=(0,a.forwardRef)((e,s)=>{let{color:t="currentColor",size:l=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:d="",children:h,iconNode:p,...u}=e;return(0,a.createElement)("svg",{ref:s,...o,width:l,height:l,stroke:t,strokeWidth:r?24*Number(n)/Number(l):n,className:c("lucide",d),...!h&&!i(u)&&{"aria-hidden":"true"},...u},[...p.map(e=>{let[s,t]=e;return(0,a.createElement)(s,t)}),...Array.isArray(h)?h:[h]])}),h=(e,s)=>{let t=(0,a.forwardRef)((t,n)=>{let{className:i,...o}=t;return(0,a.createElement)(d,{ref:n,iconNode:s,className:c("lucide-".concat(l(r(e))),"lucide-".concat(e),i),...o})});return t.displayName=r(e),t}}},e=>{var s=s=>e(e.s=s);e.O(0,[655,441,684,358],()=>s(1756)),_N_E=e.O()}]);