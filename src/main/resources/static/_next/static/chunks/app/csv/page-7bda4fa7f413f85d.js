(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[261],{722:(e,s,t)=>{"use strict";t.d(s,{A:()=>i});var r=t(3464),l=t(9323),a=t(1487);let n=r.A.create({baseURL:"http://localhost:8080/v1/api",headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>{let s=(0,l.gf)();return s&&(e.headers.Authorization="Bearer ".concat(s)),e}),n.interceptors.response.use(e=>e,e=>{var s,t;let r=null==(s=e.config.url)?void 0:s.endsWith("/login");if((null==(t=e.response)?void 0:t.status)===401&&!r){let{clearAuth:e}=a.C.getState();e(),window.location.href="/login"}return Promise.reject(e)});let i=n},1487:(e,s,t)=>{"use strict";t.d(s,{C:()=>a});var r=t(5453),l=t(6786);let a=(0,r.v)((0,l.Zr)(e=>({authName:null,token:null,setAuthName:s=>e({authName:s}),setToken:s=>e({token:s}),clearAuth:()=>e({authName:null,token:null})}),{name:"auth-storage",partialize:e=>({authName:e.authName,token:e.token})}))},2596:(e,s,t)=>{"use strict";t.d(s,{A:()=>l});var r=t(5155);function l(){return(0,r.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-[#0d113d] opacity-70 z-50",children:(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsxs)("svg",{className:"animate-spin w-16 h-16",viewBox:"0 0 50 50",children:[(0,r.jsx)("defs",{children:(0,r.jsxs)("linearGradient",{id:"spinner-gradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[(0,r.jsx)("stop",{offset:"0%",stopColor:"#3D00B8"}),(0,r.jsx)("stop",{offset:"100%",stopColor:"#3070C3"})]})}),(0,r.jsx)("circle",{cx:"25",cy:"25",r:"20",stroke:"url(#spinner-gradient)",strokeWidth:"6",fill:"none",strokeLinecap:"round"})]}),(0,r.jsx)("span",{className:"mt-4 text-lg font-semibold text-white drop-shadow",children:"ローディング中..."})]})})}},4602:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>p});var r=t(5155),l=t(2115),a=t(9946);let n=(0,a.A)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var i=t(7434);let c=(0,a.A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),d=(0,a.A)("upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),o=(0,a.A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var x=t(722),m=t(2596);function h(){let[e,s]=(0,l.useState)(null),[t,a]=(0,l.useState)(""),[h,u]=(0,l.useState)(""),[p,g]=(0,l.useState)(!1),[j,b]=(0,l.useState)(null),[f,N]=(0,l.useState)(null),[y,v]=(0,l.useState)(!1),w=async()=>{if(!e)return void u("ファイルを選択してください。");a(""),u(""),b(null);let t=new FormData;t.append("file",e);try{g(!0);let e=await x.A.post("/upload-csv",t,{headers:{"Content-Type":"multipart/form-data"}});b(e.data),a("アップロード成功: ".concat(e.data.message)),s(null);let r=document.getElementById("csv-file-input");r&&(r.value="")}catch(e){if(console.error(e),e.response&&e.response.data){let s=e.response.data;u(s.message),console.error("アップロードエラー:",s),b(s)}}finally{g(!1)}},k=async()=>{try{g(!0);let e=await x.A.get("/csv-template-info");N(e.data),v(!0)}catch(e){if(console.error(e),e.response&&e.response.data){let s=e.response.data;console.error("テンプレート情報の取得エラー:",s),u(s.message||"テンプレート情報の取得に失敗しました。")}else u("テンプレート情報の取得に失敗しました。")}finally{g(!1)}};return(0,r.jsxs)(r.Fragment,{children:[p&&(0,r.jsx)(m.A,{}),(0,r.jsxs)("div",{className:"max-w-4xl mx-auto p-6 bg-white",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"在庫CSVファイルアップロード"}),(0,r.jsx)("p",{className:"text-gray-600",children:"在庫情報が記載されたCSVファイルをアップロードして、在庫マスターに登録できます。"})]}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsxs)("button",{onClick:k,className:"inline-flex items-center px-4 py-2 bg-blue-50 hover:bg-blue-100 text-blue-700 rounded-lg transition-colors duration-200",children:[(0,r.jsx)(n,{className:"w-4 h-4 mr-2"}),"CSVテンプレート情報を確認"]})}),y&&f&&(0,r.jsxs)("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-6",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-blue-900 mb-4 flex items-center",children:[(0,r.jsx)(i.A,{className:"w-5 h-5 mr-2"}),"CSVファイル形式"]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-blue-800 mb-2",children:"必要な列（ヘッダー）:"}),(0,r.jsx)("div",{className:"bg-white p-3 rounded border border-blue-200",children:(0,r.jsx)("code",{className:"text-sm text-gray-800",children:f.headers.join(", ")})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-blue-800 mb-2",children:"各列の説明:"}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:Object.entries(f.headerDescriptions).map(e=>{let[s,t]=e;return(0,r.jsxs)("div",{className:"bg-white p-3 rounded border border-blue-200",children:[(0,r.jsxs)("span",{className:"font-medium text-gray-700",children:[s,":"]}),(0,r.jsx)("span",{className:"ml-2 text-gray-600",children:t})]},s)})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-blue-800 mb-2",children:"記入例:"}),(0,r.jsx)("div",{className:"bg-white p-3 rounded border border-blue-200 overflow-x-auto",children:(0,r.jsx)("div",{className:"grid grid-cols-8 gap-2 text-[12px]",children:Object.entries(f.example).map(e=>{let[s,t]=e;return(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"font-medium text-gray-700 mb-1",children:s}),(0,r.jsx)("div",{className:"text-gray-600",children:t})]},s)})})})]})]}),(0,r.jsx)("button",{onClick:()=>v(!1),className:"mt-4 text-blue-600 hover:text-blue-800 text-sm",children:"閉じる"})]}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)("div",{className:"border-2 border-dashed rounded-lg p-8 text-center transition-colors duration-200 ".concat(e?"border-green-400 bg-green-50":"border-gray-300 hover:border-gray-400 bg-gray-50"),onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onDrop:e=>{e.preventDefault(),e.stopPropagation();let t=e.dataTransfer.files;if(t.length>0){let e=t[0],r=e.name.toLowerCase(),l=[".csv"].some(e=>r.endsWith(e)),n=["text/csv","application/csv","text/plain"].includes(e.type);if(!l&&n)return void u("CSVファイルのみアップロード可能です。ドロップされたファイル: ".concat(e.name));if(e.type.includes("spreadsheet")||e.type.includes("excel"))return void u("Excelファイルは直接アップロードできません。CSVファイルとして保存し直してください。");s(e),a(""),u(""),b(null)}},children:(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c,{className:"w-12 h-12 text-green-500 mb-4"}),(0,r.jsx)("p",{className:"text-lg font-medium text-green-700 mb-2",children:"ファイルが選択されました"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:e.name}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:["ファイルサイズ: ",(e.size/1024).toFixed(1)," KB"]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d,{className:"w-12 h-12 text-gray-400 mb-4"}),(0,r.jsx)("p",{className:"text-lg font-medium text-gray-700 mb-2",children:"CSVファイルをドラッグ&ドロップ"}),(0,r.jsx)("p",{className:"text-gray-500 mb-4",children:"または"})]}),(0,r.jsxs)("label",{className:"cursor-pointer inline-flex items-center px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors duration-200",children:[(0,r.jsx)(i.A,{className:"w-4 h-4 mr-2"}),"ファイルを選択",(0,r.jsx)("input",{id:"csv-file-input",type:"file",accept:".csv",onChange:e=>{if(e.target.files&&e.target.files.length>0){let t=e.target.files[0],r=t.name.toLowerCase(),l=[".csv"].some(e=>r.endsWith(e)),n=["text/csv","application/csv","text/plain"].includes(t.type);if(!l&&n){u("CSVファイルのみアップロード可能です。選択されたファイル: ".concat(t.name)),s(null);return}if(t.type.includes("spreadsheet")||t.type.includes("excel")){u("Excelファイルは直接アップロードできません。CSVファイルとして保存し直してください。"),s(null);return}s(t),a(""),u(""),b(null)}},className:"hidden"})]})]})})}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)("button",{onClick:w,disabled:!e||p,className:"w-full py-4 px-6 rounded-lg font-medium transition-colors duration-200 ".concat(e&&!p?"bg-green-600 hover:bg-green-700 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:p?(0,r.jsx)(m.A,{}):(0,r.jsxs)("span",{className:"flex items-center justify-center",children:[(0,r.jsx)(d,{className:"w-5 h-5 mr-2"}),"CSVファイルをアップロード"]})})}),t&&(0,r.jsxs)("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(c,{className:"w-5 h-5 text-green-500 mr-3"}),(0,r.jsx)("span",{className:"text-green-800",children:t})]}),j&&j.success&&(0,r.jsxs)("div",{className:"mt-3 text-sm text-green-700",children:[(0,r.jsxs)("p",{children:["ファイル名: ",j.filename]}),(0,r.jsxs)("p",{children:["ファイルサイズ:"," ",void 0!==j.fileSize?(j.fileSize/1024).toFixed(1):"-"," ","KB"]})]})]}),h&&(0,r.jsxs)("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(o,{className:"w-5 h-5 text-red-500 mr-3"}),(0,r.jsx)("span",{className:"text-red-800",children:h})]}),j&&!j.success&&(0,r.jsxs)("div",{className:"mt-3 space-y-2",children:[j.expectedFormat&&(0,r.jsxs)("div",{className:"text-sm text-red-700",children:[(0,r.jsx)("p",{className:"font-medium",children:"期待されるフォーマット:"}),(0,r.jsx)("code",{className:"bg-red-100 px-2 py-1 rounded text-xs",children:j.expectedFormat})]}),j.actualHeader&&(0,r.jsxs)("div",{className:"text-sm text-red-700",children:[(0,r.jsx)("p",{className:"font-medium",children:"実際のヘッダー:"}),(0,r.jsx)("code",{className:"bg-red-100 px-2 py-1 rounded text-xs",children:j.actualHeader})]}),j.errors&&j.errors.length>0&&(0,r.jsxs)("div",{className:"text-sm text-red-700",children:[(0,r.jsxs)("p",{className:"font-medium",children:["エラー詳細 (",j.errorCount,"件):"]}),(0,r.jsxs)("ul",{className:"mt-1 list-disc list-inside space-y-1",children:[j.errors.slice(0,5).map((e,s)=>(0,r.jsx)("li",{className:"text-xs",children:e},s)),j.errors.length>5&&(0,r.jsxs)("li",{className:"text-xs text-red-600",children:["...他 ",j.errors.length-5," 件のエラー"]})]})]})]})]}),(0,r.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[(0,r.jsx)("h3",{className:"font-semibold text-yellow-800 mb-2",children:"アップロード時の注意事項"}),(0,r.jsxs)("ul",{className:"text-sm text-yellow-700 space-y-1 list-disc list-inside",children:[(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{children:"ファイル形式:"})," ","必ずCSVファイル（.csv）をアップロードしてください"]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{children:"Excelファイルの場合:"})," Excel → 「名前を付けて保存」→ 「CSV（コンマ区切り）」を選択"]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{children:"文字エンコーディング:"})," UTF-8で保存してください"]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{children:"ヘッダー行:"})," 必須です（item_name, model_number, category, manufacturer, current_stock, location）"]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{children:"必須項目:"})," ","品名（item_name）と型番（model_number）とカテゴリ（category）は必ず入力してください"]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{children:"在庫数:"})," ","数値で入力してください（未設定の場合は0になります）"]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{children:"ファイルサイズ:"})," 10MB以下にしてください"]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("strong",{children:"エラー時の正常な行について:"})," ","エラー時は正常な行も登録されません"]})]})]}),(0,r.jsxs)("div",{className:"mt-4 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,r.jsx)("h3",{className:"font-semibold text-blue-800 mb-2",children:"\uD83D\uDCCB ExcelファイルをCSVに変換する方法"}),(0,r.jsxs)("ol",{className:"text-sm text-blue-700 space-y-1 list-decimal list-inside",children:[(0,r.jsx)("li",{children:"Excelでファイルを開く"}),(0,r.jsx)("li",{children:"「ファイル」→「名前を付けて保存」を選択"}),(0,r.jsxs)("li",{children:["「ファイルの種類」で「",(0,r.jsx)("span",{className:"font-semibold",children:"CSV UTF-8（コンマ区切り）(*.csv)"}),"」を選択"]}),(0,r.jsx)("li",{children:"保存して、そのCSVファイルをアップロードしてください"})]})]})]})]})}function u(){return(0,r.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,r.jsx)("div",{className:"container mx-auto py-8",children:(0,r.jsx)(h,{})})})}function p(){return(0,r.jsx)("main",{className:"bg-white border-gray-400 shadow p-5",children:(0,r.jsx)(u,{})})}},6125:(e,s,t)=>{Promise.resolve().then(t.bind(t,4602))},7434:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(9946).A)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},9323:(e,s,t)=>{"use strict";t.d(s,{EN:()=>a,gf:()=>i,ri:()=>n});var r=t(1487),l=t(722);let a=async(e,s)=>{let t=await l.A.post("/login",{username:e,password:s});console.log("axios response:",t);let a=t.data.data.token,n=t.data.data.username;if(!a)throw Error("トークンが取得できませんでした");r.C.getState().setToken(a),r.C.getState().setAuthName(n)},n=()=>{r.C.getState().clearAuth()},i=()=>r.C.getState().token||localStorage.getItem("authToken")},9946:(e,s,t)=>{"use strict";t.d(s,{A:()=>x});var r=t(2115);let l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,s,t)=>t?t.toUpperCase():s.toLowerCase()),n=e=>{let s=a(e);return s.charAt(0).toUpperCase()+s.slice(1)},i=function(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return s.filter((e,s,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===s).join(" ").trim()},c=e=>{for(let s in e)if(s.startsWith("aria-")||"role"===s||"title"===s)return!0};var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,r.forwardRef)((e,s)=>{let{color:t="currentColor",size:l=24,strokeWidth:a=2,absoluteStrokeWidth:n,className:o="",children:x,iconNode:m,...h}=e;return(0,r.createElement)("svg",{ref:s,...d,width:l,height:l,stroke:t,strokeWidth:n?24*Number(a)/Number(l):a,className:i("lucide",o),...!x&&!c(h)&&{"aria-hidden":"true"},...h},[...m.map(e=>{let[s,t]=e;return(0,r.createElement)(s,t)}),...Array.isArray(x)?x:[x]])}),x=(e,s)=>{let t=(0,r.forwardRef)((t,a)=>{let{className:c,...d}=t;return(0,r.createElement)(o,{ref:a,iconNode:s,className:i("lucide-".concat(l(n(e))),"lucide-".concat(e),c),...d})});return t.displayName=n(e),t}}},e=>{var s=s=>e(e.s=s);e.O(0,[655,441,684,358],()=>s(6125)),_N_E=e.O()}]);