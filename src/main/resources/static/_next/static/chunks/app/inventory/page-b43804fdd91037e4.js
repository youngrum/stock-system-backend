(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[693],{1209:(e,t,s)=>{Promise.resolve().then(s.bind(s,9646))},9646:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>v});var a=s(5155),l=s(6874),n=s.n(l),r=s(7039),o=s(9799),c=s(3786),i=s(8804);function d(e){let{data:t,onReceive:s,onDispach:l}=e;return(0,a.jsx)("div",{className:"overflow-x-auto bg-white",children:(0,a.jsxs)("table",{className:"w-full text-[12px] text-center border-collapse",children:[(0,a.jsx)("thead",{style:{color:"#101540"},children:(0,a.jsxs)("tr",{className:"font-semibold",children:[(0,a.jsx)("th",{className:"text-base pl-4 pr-1 py-3 max-w-[60px]",children:"入庫"}),(0,a.jsx)("th",{className:"text-base pl-4 pr-1 py-3 max-w-[60px]",children:"出庫"}),(0,a.jsx)("th",{className:"text-base px-4 py-3",children:"ID"}),(0,a.jsx)("th",{className:"text-base px-4 py-3",children:"品名"}),(0,a.jsx)("th",{className:"text-base px-4 py-3",children:"カテゴリ"}),(0,a.jsx)("th",{className:"text-base px-4 py-3",children:"型番・規格"}),(0,a.jsx)("th",{className:"text-base px-4 py-3",children:"メーカー"}),(0,a.jsx)("th",{className:"text-base px-4 py-3",children:"在庫数"}),(0,a.jsx)("th",{className:"text-base px-4 py-3",children:"保管先"}),(0,a.jsx)("th",{className:"text-base px-4 py-3",children:"更新日"}),(0,a.jsx)("th",{className:"text-base px-4 py-3",children:"履歴"})]})}),(0,a.jsx)("tbody",{className:"text-gray-700",children:t.map(e=>{var t;return(0,a.jsxs)("tr",{className:"hover:bg-gray-200",style:{borderBottom:"1px solid #101540"},children:[(0,a.jsx)("td",{className:"pl-4 pr-1 py-3 items-center max-w-[50px]",children:(0,a.jsx)(n(),{href:"#",onClick:()=>s(e),className:"text-[#0d113d]",children:(0,a.jsx)(r.A,{className:"mx-auto"})})}),(0,a.jsx)("td",{className:"pl-4 pr-1 py-3 max-w-[50px]",children:(0,a.jsx)(n(),{href:"#",onClick:t=>{0===e.currentStock?t.preventDefault():l(e)},className:"text-[#0d113d] ".concat(0===e.currentStock?"opacity-50 cursor-not-allowed":""),title:0==e.currentStock?"在庫0です":void 0,children:(0,a.jsx)(o.A,{className:"mx-auto"})})}),(0,a.jsx)("td",{className:"px-4 py-3",title:e.itemCode,children:e.itemCode}),(0,a.jsx)("td",{className:"px-4 py-3 max-w-[300px] truncate",title:e.itemName,children:e.itemName}),(0,a.jsx)("td",{className:"px-4 py-3",title:e.category,children:e.category}),(0,a.jsx)("td",{className:"px-4 py-3 max-w-[300px] truncate",children:null!=(t=e.modelNumber)?t:"-"}),(0,a.jsx)("td",{className:"px-4 py-3",title:e.manufacturer,children:e.manufacturer}),(0,a.jsx)("td",{className:"px-4 py-3",children:(0,a.jsx)("span",{className:0===e.currentStock?"text-red-500":"",children:e.currentStock})}),(0,a.jsx)("td",{className:"px-4 py-3 truncate  max-w-[150px]",title:e.location,children:e.location}),(0,a.jsx)("td",{className:"px-4 py-3",children:(0,i.Y)(e.lastUpdated)}),(0,a.jsx)("td",{className:"pl-4 pr-1 line-through",children:(0,a.jsx)("button",{onClick:e=>e.preventDefault(),className:"text-[#0d113d] cursor-not-allowed",disabled:!0,children:(0,a.jsx)(c.A,{className:"mx-auto"})})})]},e.itemCode)})})]})})}var x=s(2115),u=s(4416),m=s(722),p=s(2596);function h(e){let{isOpen:t,onClose:s,onSuccess:l,itemCode:n}=e,[r,o]=(0,x.useState)(null),[c,i]=(0,x.useState)(),[d,h]=(0,x.useState)(""),[g,y]=(0,x.useState)(),[j,b]=(0,x.useState)(),[f,N]=(0,x.useState)(""),[v,w]=(0,x.useState)(!1);(0,x.useEffect)(()=>{t&&n&&m.A.get("/inventory/".concat(n)).then(e=>o(e.data.data)).catch(()=>s())},[t,n,s]);let C=async()=>{if(c&&!(c<=0)){if(!window.confirm("本当にこの内容で入庫しますか？\n在庫ID:".concat(n,"\n品名：").concat((null==r?void 0:r.itemName)||"不明","\nカテゴリー：").concat((null==r?void 0:r.category)||"不明","\n仕入先: ").concat(d||"不明","\n↓\n数量: ").concat(c,"\n単価: ").concat(g||"未入力","\n送料: ").concat(j||"未入力","\n備考: ").concat(f||"なし")))return void window.confirm("処理を取り消しました");w(!0);try{console.log("%o",r);let e=(await m.A.post("/inventory/receive/".concat(n),{itemCode:(null==r?void 0:r.itemCode)||null,quantity:c,supplier:d||"不明",purchasePrice:g||0,shippingFee:j||0,remarks:f||"-"})).data;console.log(e),alert("入庫登録に成功しました（実行処理id: ".concat(e.transactionId,"）")),s(),l()}catch(e){if(console.error(e),e.response&&e.response.data){let t=e.response.data;alert("エラーが発生しました！以下の内容を管理者に伝えてください。\n・error: ".concat(t.error,"\n・massage: ").concat(t.message,"\n・status: ").concat(t.status))}}finally{w(!1)}}};return t&&r?(0,a.jsxs)(a.Fragment,{children:[v&&(0,a.jsx)(p.A,{}),(0,a.jsxs)("div",{className:"fixed inset-0 z-30 flex items-center justify-center",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-[#0d113d] opacity-40",onClick:s}),(0,a.jsxs)("div",{className:"relative z-10 bg-white w-[800px] rounded shadow-lg p-6 grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsx)("button",{onClick:s,className:"absolute top-4 right-5 text-gray-500 hover:text-gray-800",children:(0,a.jsx)(u.A,{className:"text-[#0d113d]"})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:r.itemName}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[r.itemCode," "]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:r.modelNumber}),(0,a.jsxs)("p",{className:"text-[#0d113d]",children:["カテゴリ: ",r.category]}),(0,a.jsxs)("p",{className:"text-[#0d113d]",children:["メーカー: ",r.manufacturer]}),(0,a.jsxs)("p",{className:"text-[#0d113d]",children:["現在庫:"," ",(0,a.jsx)("span",{className:"font-semibold",children:r.currentStock})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium",children:"数量*"}),(0,a.jsx)("input",{type:"number",min:1,value:c,onChange:e=>i(Number(e.target.value)),className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-gray-100",style:{border:"1px solid #9F9F9F"},placeholder:"1"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium",children:"仕入先（任意）"}),(0,a.jsx)("input",{type:"text",value:d,onChange:e=>h(e.target.value),className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-gray-100",style:{border:"1px solid #9F9F9F"},placeholder:"ここに仕入先を入力"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium",children:"単価（任意）"}),(0,a.jsx)("input",{type:"number",value:g,min:0,onChange:e=>y(Number(e.target.value)),className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-gray-100",style:{border:"1px solid #9F9F9F"},placeholder:"150"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium",children:"送料（任意）"}),(0,a.jsx)("input",{type:"number",value:j,min:0,onChange:e=>b(Number(e.target.value)),className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-gray-100",style:{border:"1px solid #9F9F9F"},placeholder:"1000"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium",children:"備考（任意）"}),(0,a.jsx)("textarea",{value:f,onChange:e=>N(e.target.value),className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-gray-100",rows:2,style:{border:"1px solid #9F9F9F"},placeholder:"716・717案件"})]}),(0,a.jsx)("button",{onClick:C,disabled:v,className:"w-full text-white py-2 rounded hover:opacity-90",style:{background:"linear-gradient(to bottom, #3D00B8, #3070C3)"},children:v?"登録中...":"入庫する"})]})]})]})]}):null}function g(e){let{isOpen:t,onClose:s,onSuccess:l,itemCode:n}=e,[r,o]=(0,x.useState)(null),[c,i]=(0,x.useState)(),[d,h]=(0,x.useState)(""),[g,y]=(0,x.useState)(!1);(0,x.useEffect)(()=>{t&&n&&m.A.get("/inventory/".concat(n)).then(e=>o(e.data.data)).catch(()=>s())},[t,n,s]);let j=async()=>{if(r&&c&&!(c<=0)){if(r.currentStock<c)return void alert("出庫可能な数量は現在の在庫数(".concat(r.currentStock,")以下である必要があります。"));if(!window.confirm("この内容で出庫しますか？\n在庫ID:".concat(n,"\n品名：").concat(null==r?void 0:r.itemName,"\nカテゴリー：").concat(null==r?void 0:r.category,"\n数量: ").concat(c,"\n備考: ").concat(d||"なし")))return void window.confirm("処理を取り消しました");y(!0);try{console.log("%o",r);let e=await m.A.post("/inventory/dispatch/".concat(n),{itemCode:(null==r?void 0:r.itemCode)||null,quantity:c,remarks:d});s(),l();let t=e.data.data;console.log(t),alert("出庫登録に成功しました（実行処理id: ".concat(t.transactionId,"）"))}catch(e){if(e.response&&e.response.data){let t=e.response.data;alert("エラーが発生しました！以下の内容を管理者に伝えてください。\n・error: ".concat(t.error,"\n・massage: ").concat(t.message,"\n・status: ").concat(t.status))}else console.log(e)}finally{y(!1)}}};return t&&r?(0,a.jsxs)(a.Fragment,{children:[g&&(0,a.jsx)(p.A,{}),(0,a.jsxs)("div",{className:"fixed inset-0 z-30 flex items-center justify-center",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-[#0d113d] opacity-40",onClick:s}),(0,a.jsxs)("div",{className:"relative z-10 bg-white w-[800px] rounded shadow-lg p-6 grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsx)("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-800",children:(0,a.jsx)(u.A,{className:"text-[#0d113d]"})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:r.itemName}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:n}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:r.modelNumber}),(0,a.jsxs)("p",{children:["カテゴリ: ",r.category]}),(0,a.jsxs)("p",{children:["メーカー: ",r.manufacturer]}),(0,a.jsxs)("p",{children:["現在庫:",(0,a.jsx)("span",{className:0==r.currentStock?"text-red-700":"",children:r.currentStock})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium",children:"数量*"}),(0,a.jsx)("input",{type:"number",min:1,placeholder:"1",value:c,onChange:e=>i(Number(e.target.value)),className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-gray-100",style:{border:"1px solid #9F9F9F"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium",children:"備考（任意）"}),(0,a.jsx)("textarea",{value:d,onChange:e=>h(e.target.value),className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-gray-100",rows:3,style:{border:"1px solid #9F9F9F"}})]}),(0,a.jsx)("button",{onClick:j,disabled:g,className:"w-full bg-gradient-to-r text-white py-2 rounded hover:opacity-90",style:{background:"linear-gradient(to bottom, #5A00E0, #7040D0)"},children:g?"出庫中...":"出庫する"})]})]})]})]}):null}var y=s(7924);function j(e){let{onSearch:t}=e,[s,l]=(0,x.useState)(""),[n,r]=(0,x.useState)(""),[o,c]=(0,x.useState)(""),[i,d]=(0,x.useState)("");return(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),console.log("\uD83D\uDD0D フォーム送信時の検索条件",{itemCode:s,itemName:n,category:o,modelNumber:i}),t({itemCode:s||void 0,itemName:n||void 0,category:o||void 0,modelNumber:i||void 0})},className:"p-6 border-b mb-6 transition-all duration-300 ease-in-out animate-fade-in",style:{borderBottom:"1px solid #101540"},children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsx)("div",{children:(0,a.jsx)("input",{type:"text",value:s,onChange:e=>l(e.target.value),placeholder:"IDを入力",className:"w-full px-3 py-2 text-[#0d113d] rounded focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-gray-100",style:{border:"1px solid #9F9F9F"}})}),(0,a.jsx)("div",{children:(0,a.jsx)("input",{type:"text",value:n,onChange:e=>r(e.target.value),placeholder:"品名を入力",className:"w-full px-3 py-2 text-[#0d113d] rounded focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-gray-100",style:{border:"1px solid #9F9F9F"}})}),(0,a.jsx)("div",{children:(0,a.jsx)("input",{type:"text",value:o,onChange:e=>c(e.target.value),placeholder:"カテゴリーを入力",className:"w-full px-3 py-2 text-[#0d113d] rounded focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-gray-100",style:{border:"1px solid #9F9F9F"}})}),(0,a.jsx)("div",{children:(0,a.jsx)("input",{type:"text",value:i,onChange:e=>d(e.target.value),placeholder:"型番・規格を入力",className:"w-full px-3 py-2 text-[#0d113d] rounded focus:outline-none focus:ring-2 focus:ring-indigo-500 bg-gray-100",style:{border:"1px solid #9F9F9F"}})})]}),(0,a.jsx)("div",{className:"flex justify-center mt-6",children:(0,a.jsx)("button",{type:"submit",className:"text-black px-4 py-2 rounded shadow-md hover:opacity-90",style:{background:"linear-gradient(to bottom, #3D00B8, #3070C3)"},children:(0,a.jsx)(y.A,{className:"text-white",width:30,height:30})})})]})}var b=s(321),f=s(6918),N=s(5695);function v(){let e=(0,N.useRouter)(),t=(0,f.z)(),[s,l]=(0,x.useState)([]),[n,r]=(0,x.useState)(!0),[o,c]=(0,x.useState)(""),[i,v]=(0,x.useState)(!1),[w,C]=(0,x.useState)({itemCode:"",itemName:"",category:"",modelNumber:""}),[k,S]=(0,x.useState)(null),[F,A]=(0,x.useState)(!1),[D,E]=(0,x.useState)(!1),[I,P]=(0,x.useState)(0),[_,z]=(0,x.useState)(0),B=(0,x.useCallback)(async()=>{try{let e=await m.A.get("/inventory/search",{params:{...w,page:I}});console.log(e.data.data.content),l(e.data.data.content),z(e.data.data.totalPages)}catch(e){if(console.error(e),e.response&&e.response.data){let t=e.response.data;alert("エラーが発生しました！以下の内容を管理者に伝えてください。\n・error: ".concat(t.error,"\n・massage: ").concat(t.message,"\n・status: ").concat(t.status))}c("在庫データの取得に失敗しました")}finally{r(!1)}},[w,I]);return(0,x.useEffect)(()=>{t&&B()},[B,t]),(0,a.jsxs)("main",{className:"bg-white border-gray-400 shadow p-5",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-800 text-",style:{color:"#101540"},children:"在庫一覧・検索"}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("button",{onClick:()=>v(e=>!e),className:"text-[#101540] hover:text-indigo-600 text-xl focus:outline-none transition-transform duration-300 ".concat(i?"rotate-180":"rotate-0"),"aria-label":"検索フォーム切り替え",children:i?(0,a.jsx)(u.A,{className:"text-[#0d113d]",width:30,height:30}):(0,a.jsx)(y.A,{className:"text-[#0d113d]",width:30,height:30})}),(0,a.jsx)("button",{className:"px-5 py-3 border rounded p-2 hover:bg-[#1d1f3c] hover:text-gray-200 text-xl",onClick:()=>e.push("/csv"),children:"import with csv"}),(0,a.jsx)("button",{className:"px-5 py-3 text-xl font-medium text-white rounded shadow-md hover:opacity-90",style:{background:"linear-gradient(to bottom, #3D00B8, #3070C3)"},onClick:()=>e.push("/inventory/new"),children:"＋ 新規在庫登録"})]})]}),(0,a.jsx)("div",{className:"\n          transition-all duration-500 ease-in-out overflow-hidden\n          ".concat(i?"max-h-[400px]":"max-h-0","\n        "),children:(0,a.jsx)(j,{onSearch:C})}),o&&(0,a.jsx)("p",{children:o}),n?(0,a.jsx)(p.A,{}):(0,a.jsx)(d,{data:s,onReceive:e=>{S(e),A(!0)},onDispach:e=>{S(e),E(!0)}}),k&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h,{isOpen:F,onClose:()=>A(!1),itemCode:k.itemCode,onSuccess:B}),(0,a.jsx)(g,{isOpen:D,onClose:()=>E(!1),itemCode:k.itemCode,onSuccess:B})]}),(0,a.jsx)(b.A,{currentPage:I,totalPages:_,onPageChange:P})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[655,244,614,441,684,358],()=>t(1209)),_N_E=e.O()}]);